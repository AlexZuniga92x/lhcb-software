      REAL FUNCTION calib()
*********************************************************
*                                                       *
* This file was generated by HUWFUN.                    *
*                                                       *
*********************************************************
*
*     Ntuple Id:      1    
*     Ntuple Title:    PI0 tuple
*     Creation:       20/08/2006 12.38.22
*
*********************************************************
*
      include ?
C$$      LOGICAL         CHAIN
C$$      CHARACTER*128   CFILE
C$$      INTEGER         IDNEVT,NCHEVT,ICHEVT
C$$      REAL            OBS(13)
C$$*
C$$      COMMON /PAWIDN/ IDNEVT,OBS
C$$      COMMON /PAWCHN/ CHAIN, NCHEVT, ICHEVT
C$$      COMMON /PAWCHC/ CFILE
C$$*
C$$*--   Ntuple Variable Declarations
C$$*
C$$      REAL m12,p0E,p0X,p0Y,p0Z,g1E,g1X,g1Y,g1Z,g2E,g2X,g2Y,g2Z,pt,pt1
C$$     + ,pt2,prs1,prs2
C$$      INTEGER cel1a,cel1r,cel1c,cel2a,cel2r,cel2c,ind1,ind2
C$$*
C$$      COMMON /PAWCR4/ m12,p0E,p0X,p0Y,p0Z,g1E,g1X,g1Y,g1Z,g2E,g2X,g2Y
C$$     + ,g2Z,pt,pt1,pt2,prs1,prs2,cel1a,cel1r,cel1c,cel2a,cel2r,cel2c
C$$     + ,ind1,ind2
*
      INTEGER IC1, IC2,IHID0,IHID1,IHID2,IFLAG,NCAT
      REAL    AMASS 
      
      REAL R1,R2,RMAX
      INTEGER IR,IHIDR
*
*--   Enter user code here
*

      VECTOR ALAM
      VECTOR CATN 
*
      calib = 1.
*
*      IF ( PT    .LE. 1.0   ) RETURN 
      IF ( CEL1A .NE. CEL2A ) RETURN 
*
*      IF ( PRS1  .GE. 0.030 ) RETURN 
*      IF ( PRS2  .GE. 0.030 ) RETURN 
*      IF ( PT1   .LT. 0.300 ) RETURN 
*      IF ( PT2   .LT. 0.300 ) RETURN 
*
      NCAT = CATN(1) 
      IC1  =MOD(ind1,NCAT)
      IC2  =MOD(ind2,NCAT)
*
      IHID0=10000
      IHID1=10000+IC1+1
      IHID2=10000+IC2+1 
*
      
*     calculate the corrected mass      
      AMASS = M12 * SQRT ( ALAM(IC1+1) * ALAM(IC2+1) )
      
      IFLAG = 0 
*     fill the histos 
      IF ( PRS1 .LE. 0.010 .AND. PT1 .GE. 0.300 ) THEN
        CALL HF1( IHID1 , AMASS , 1.0 )
        IFLAG = 1 
      ENDIF
      IF ( PRS2 .LE. 0.010 .AND. PT2 .GE. 0.300 ) THEN
        CALL HF1( IHID2 , AMASS , 1.0 ) 
        IFLAG = 1 
      ENDIF     
      
*     "ALL" pi0s 
      IF ( 0 .LT. IFLAG ) THEN
        CALL HF1( IHID0 , AMASS , 1.0 )
      ENDIF
*
      RETURN
*
      END
      
