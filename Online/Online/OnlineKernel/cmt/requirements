package OnlineKernel
version v1r10

branches  cmt doc src
use GaudiPolicy v*
use Reflex      v* LCG_Interfaces -no_auto_imports

apply_pattern install_more_includes more=OnlineKernel

library       OnlineKernel ../src/WT/*.cpp      \
                           ../src/MBM/*.cpp     \
                           ../src/RTL/*.cpp     \
                           ../src/PUBAREA/*.cpp \
                           ../src/TAN/*.cpp     \
                           ../src/AMS/*.cpp     \
                           ../src/SCR/*.cpp     \
                           ../src/CPP/*.cpp     \
                           ../src/NET/*.cpp

macro_append  OnlineKernel_shlibflags ' -lpthread -lrt -lcurses ' WIN32 ' '
apply_pattern ld_library_path
apply_pattern linker_library          library=OnlineKernel
application   test                    ../main/wt.cpp
application   gentest                 ../main/gentest.cpp
application   mbm_remove              ../main/mbm_remove.cpp
macro_append  test_dependencies       " OnlineKernel "
macro_append  gentest_dependencies    " OnlineKernel "
macro_append  mbm_remove_dependencies " OnlineKernel "
macro_append  use_includes            ' $(ppcmd)"$(OnlineKernel_cmtpath)/$(cmt_installarea_prefix)/include/OnlineKernel" '
macro_append  use_linkopts            ' -ldl ' WIN32 ''
path_remove PYTHONPATH                '/OnlineKernel/'    WIN32 '\OnlineKernel\'
path_append PYTHONPATH                $(ONLINEKERNELROOT)/python

###  macro cpp 'gcc32 -m32 '
###  macro shlibbuilder 'g++32 -m32 $(cmt_installarea_linkopts) '

apply_pattern reflex_dictionary dictionary=OnlineKernel \
                                headerfiles=$(ONLINEKERNELROOT)/dict/dictionary.h \
                                selectionfile=$(ONLINEKERNELROOT)/dict/dictionary.xml \
                                imports=Python
macro_append OnlineKernel_reflex_options " -D__GCCXML"

# Gnerate dictionary rootmap file
apply_pattern generate_rootmap library=OnlineKernelDict
apply_pattern declare_python_modules files=*.py

apply_pattern QMTest
apply_pattern QMTestSummarize

private
macro_append  use_includes ' $(ppcmd)"$(ONLINEKERNELROOT)/OnlineKernel" '
macro_append  cppflags     " -ansi -pedantic -W -Wall -Woverloaded-virtual -Wno-long-long -Wnon-virtual-dtor -Wwrite-strings -Wpointer-arith -Wno-non-template-friend -Wimplicit -Wreturn-type -Wunused -Wparentheses -Wctor-dtor-privacy -pthread -fmessage-length=0 -ftemplate-depth-300 " WIN32 ""
