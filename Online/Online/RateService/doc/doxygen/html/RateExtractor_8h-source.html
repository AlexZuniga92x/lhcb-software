<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RateService_v2r1: /afs/cern.ch/user/j/jmenou/cmtuser/Online_v4r10/Online/RateService/v2r1/src/RateExtractor.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>/afs/cern.ch/user/j/jmenou/cmtuser/Online_v4r10/Online/RateService/v2r1/src/RateExtractor.h</h1><a href="RateExtractor_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef RATESERVICE_RATEEXTRACTOR_H_</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define RATESERVICE_RATEEXTRACTOR_H_</span>
00003 <span class="preprocessor"></span>
00004 
00005 <span class="preprocessor">#include "dis.hxx"</span>
00006 <span class="preprocessor">#include &lt;string&gt;</span>
00007 
00008 <span class="keyword">class </span>MonRate;
00009 
00010 
00011 <span class="comment">/* standard label to identify rate services.</span>
00012 <span class="comment"> * "rate services" comment service should begin with this label.</span>
00013 <span class="comment"> */</span>
00014 <span class="keyword">static</span> <span class="keyword">const</span> std::string <a class="code" href="RateExtractor_8h.html#a1">s_rateServiceCommentLabel</a>(<span class="stringliteral">"[rate]"</span>);
00015 
00016 <span class="comment">/* format of structured data sent by DIM</span>
00017 <span class="comment"> */</span>
00018 <span class="keyword">static</span> <span class="keyword">const</span> std::string <a class="code" href="RateExtractor_8h.html#a2">s_rateServiceFormat</a>(<span class="stringliteral">"D:1;C"</span>);
00019 
00020 <span class="comment">/* maximum size of a rate comment</span>
00021 <span class="comment"> * 128 =&gt; 127 (max) characters + 1 null character</span>
00022 <span class="comment"> */</span>
<a name="l00023"></a><a class="code" href="RateExtractor_8h.html#a0">00023</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="RateExtractor_8h.html#a0">s_maxRateCommentSize</a> = 128;
00024 
00025 
<a name="l00032"></a><a class="code" href="classRateExtractor.html">00032</a> <span class="keyword">class </span><a class="code" href="classRateExtractor.html">RateExtractor</a>
00033 {
00034 
<a name="l00037"></a><a class="code" href="structRateExtractor_1_1RateExtractorData.html">00037</a>   <span class="keyword">struct </span><a class="code" href="structRateExtractor_1_1RateExtractorData.html">RateExtractorData</a>
00038   {
<a name="l00041"></a><a class="code" href="structRateExtractor_1_1RateExtractorData.html#o0">00041</a>     <span class="keywordtype">double</span> <a class="code" href="structRateExtractor_1_1RateExtractorData.html#o0">value</a>;
00042     
<a name="l00046"></a><a class="code" href="structRateExtractor_1_1RateExtractorData.html#o1">00046</a>     <span class="keywordtype">char</span> <a class="code" href="structRateExtractor_1_1RateExtractorData.html#o1">comment</a>[<a class="code" href="RateExtractor_8h.html#a0">s_maxRateCommentSize</a>];
00047   };    
00048     
00049 <span class="keyword">public</span>:
00050   
00056   <a class="code" href="classRateExtractor.html#a0">RateExtractor</a>(std::string rateId, MonRate * pMonRate);
00057   
00058   
00061   <a class="code" href="classRateExtractor.html#a1">~RateExtractor</a>();
00062   
00063   
<a name="l00067"></a><a class="code" href="classRateExtractor.html#a2">00067</a>   <span class="keywordtype">double</span> &amp; <a class="code" href="classRateExtractor.html#a2">getRateValue</a>(){ <span class="keywordflow">return</span> <a class="code" href="classRateExtractor.html#r3">m_data</a>.<a class="code" href="structRateExtractor_1_1RateExtractorData.html#o0">value</a>; }
00068   
<a name="l00072"></a><a class="code" href="classRateExtractor.html#a3">00072</a>   <span class="keywordtype">char</span> *   <a class="code" href="classRateExtractor.html#a3">getRateComment</a>(){ <span class="keywordflow">return</span> <a class="code" href="classRateExtractor.html#r3">m_data</a>.<a class="code" href="structRateExtractor_1_1RateExtractorData.html#o1">comment</a>; }
00073   
<a name="l00077"></a><a class="code" href="classRateExtractor.html#a4">00077</a>   std::string <a class="code" href="classRateExtractor.html#a4">getRateId</a>(){ <span class="keywordflow">return</span> <a class="code" href="classRateExtractor.html#r1">m_rateId</a>; }
00078   
00079   
00086   <span class="keywordtype">bool</span>     <a class="code" href="classRateExtractor.html#a5">extractData</a>(longlong time);
00087   
00088   
00093   <span class="keywordtype">void</span> <a class="code" href="classRateExtractor.html#a6">publishServices</a>(std::string nameHeader);
00094   
00095 <span class="keyword">private</span>:
00096 
00097   <span class="comment">//std::string makeValueServiceName(std::string nameHeader);</span>
00098   <span class="comment">//std::string makeCommentServiceName(std::string nameHeader);</span>
00099   
00100   
00107   std::string <a class="code" href="classRateExtractor.html#d0">makeServiceName</a>(std::string nameHeader);
00108   
00109   
00113   <span class="keywordtype">void</span> <a class="code" href="classRateExtractor.html#d1">reshapeComment</a>();
00114   
00115   <span class="comment">/*====================================================*/</span>
00116   <span class="comment">/*======= DIM SERVICES ===============================*/</span>
00117   <span class="comment">/*====================================================*/</span>
00118   <span class="comment">/* pointer to published services</span>
00119 <span class="comment">   *</span>
00120 <span class="comment">  DimService * m_valueService;</span>
00121 <span class="comment">  DimService * m_commentService;*/</span>
00122   
<a name="l00125"></a><a class="code" href="classRateExtractor.html#r0">00125</a>   DimService * <a class="code" href="classRateExtractor.html#r0">m_structuredService</a>;
00126   <span class="comment">/*====================================================*/</span>
00127   <span class="comment">/*====================================================*/</span>
00128   
00129   
00130   
00131   
00132   <span class="comment">/*====================================================*/</span>
00133   <span class="comment">/*======= MONRATE RELATED INFORMATION ================*/</span>
00134   <span class="comment">/*====================================================*/</span>
<a name="l00137"></a><a class="code" href="classRateExtractor.html#r1">00137</a>   std::string <a class="code" href="classRateExtractor.html#r1">m_rateId</a>;
00138   
<a name="l00141"></a><a class="code" href="classRateExtractor.html#r2">00141</a>   MonRate * <a class="code" href="classRateExtractor.html#r2">m_pMonRate</a>;
00142   <span class="comment">/*====================================================*/</span>
00143   <span class="comment">/*====================================================*/</span>
00144   
00145   
00146   
00147   
00148   <span class="comment">/*====================================================*/</span>
00149   <span class="comment">/*======= SENT DATA AND RELATED ======================*/</span>
00150   <span class="comment">/*====================================================*/</span>
<a name="l00153"></a><a class="code" href="classRateExtractor.html#r3">00153</a>   <a class="code" href="structRateExtractor_1_1RateExtractorData.html">RateExtractorData</a> <a class="code" href="classRateExtractor.html#r3">m_data</a>;
00154   
<a name="l00158"></a><a class="code" href="classRateExtractor.html#r4">00158</a>   <span class="keywordtype">int</span> <a class="code" href="classRateExtractor.html#r4">m_commentSize</a>;
00159   
00164   <span class="keywordtype">int</span> <a class="code" href="classRateExtractor.html#d2">sentDataSize</a>();
00165    
00166   <span class="comment">// /* calculated rate value</span>
00167   <span class="comment">//  *</span>
00168   <span class="comment">// double m_rateValue;*/</span>
00169   <span class="comment">// </span>
00170   <span class="comment">// /* comment of the processed counter.</span>
00171   <span class="comment">//  *</span>
00172   <span class="comment">// std::string m_comment;*/</span>
00173   
00174   <span class="comment">// /* char * version for publishing</span>
00175   <span class="comment">//  *</span>
00176   <span class="comment">// char * m_cComment;*/</span>
00177   <span class="comment">/*====================================================*/</span>
00178   <span class="comment">/*====================================================*/</span>
00179     
00180     
00181   <span class="comment">/*====================================================*/</span>
00182   <span class="comment">/*======= COUNTERS AND TIME ==========================*/</span>
00183   <span class="comment">/*====================================================*/</span>
<a name="l00186"></a><a class="code" href="classRateExtractor.html#r5">00186</a>   <span class="keywordtype">double</span> <a class="code" href="classRateExtractor.html#r5">m_counterOldValue</a>;
<a name="l00187"></a><a class="code" href="classRateExtractor.html#r6">00187</a>   <span class="keywordtype">double</span> <a class="code" href="classRateExtractor.html#r6">m_counterNewValue</a>;
00188   
<a name="l00191"></a><a class="code" href="classRateExtractor.html#r7">00191</a>   longlong <a class="code" href="classRateExtractor.html#r7">m_oldTime</a>;
<a name="l00192"></a><a class="code" href="classRateExtractor.html#r8">00192</a>   longlong <a class="code" href="classRateExtractor.html#r8">m_newTime</a>;
00193   <span class="comment">/*====================================================*/</span>
00194   <span class="comment">/*====================================================*/</span>
00195 };
00196 
00197 <span class="preprocessor">#endif</span>
00198 <span class="preprocessor"></span>
00199 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Aug 25 14:55:24 2008 for RateService_v2r1 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
