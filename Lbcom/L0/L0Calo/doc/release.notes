! $Id: release.notes,v 1.113 2008-07-17 20:38:38 robbep Exp $
! Package	        : L0/L0Calo
! Package Manager : Patrick Robbe & M-H. Schune
!--------------------------------------------------------------------------

! 2008-07-17 - Patrick Robbe
 - L0CaloAlg, L0CaloCandidatesFromRaw and L0CaloCandidatesFromRawBank: use
   RawBankReadoutStatus class to store status of L0Calo banks decoding.

!========================= L0Calo v9r15 2008-07-17 ========================
! 2008-07-17 - Olivier Deschamps
  - L0CaloAlg : add 'WriteOnTES' property. Writing L0CaloCandidate on  TES is
    now independant on 'StoreInBuffer' as in L0Muon and L0DU.

! 2008-07-16 - Patrick Robbe
 - src/L0CaloAlg.cpp: decides which candidate to take in case of equality
   to mimic electronics behaviour
 - src/DumpL0CaloBanks.h/.cpp: add the possibility to dump non-zero
   suppressed banks and error banks
 - src/L0CaloCompare.cpp: protect against missing SPD and SumEt candidates

! 2008-07-11 - Patrick Robbe
 - src/L0CaloCompare.cpp: remove compilation warnings

! 2008-07-10 - Patrick Robbe
 - src/L0CaloCompare.cpp: give names to histograms and add comparison of
   SPD multiplicity.
 - src/L0CaloMonit.cpp: give names to histograms

!========================= L0Calo v9r14 2008-07-02 ========================
! 2008-06-18 - Patrick Robbe
 - src/L0CaloCandidatesFromRawBank: skip candidates which are flagged
   as masked in the L0Calo TELL1
 - src/L0CaloAlg:
   . add the possibility to create LUT for the TVB, which will be loaded
     in the real electronics
   . use left address instead of right address for the global pi0 
 - src/DumpL0CaloBanks: new algorithm to dump the content of the L0Calo
   banks for debugging

!========================= L0Calo v9r13p1 2008-06-02 ======================
! 2008-06-02 - Marco Cattaneo
 - Fix trivial compilation warning

!========================= L0Calo v9r13 2008-05-16 ========================
! 2008-05-16 - Patrick Robbe
 - src/L0CaloCandidatesFromRaw: protect against missing L0Calo bank

!========================= L0Calo v9r12 2008-04-22 ========================
! 2008-04-10 - Patrick Robbe
 - src/L0CaloAlg: add options to use or not PS/SPD and ECAL information
   resp. to build electromagnetic and hadron candidates. Default is to
   use it.
 - src/L0CaloCandidatesFromRawBank.cpp: protect against null pointer 
   in debugging output.

! 2008-04-02 - Patrick Robbe
 - src/L0CaloMonit.cpp and src/L0CaloNtpMonitor.cpp: protect against non
   existing input data
 - src/L0CaloCandidateFromRaw.cpp: protect against non existing input data
   and change output level of debugging messages

! 2008-03-28 - Patrick Robbe
 - src/L0CaloMonit.cpp: add an option (false by default) not to produce
   detailed histograms.

! 2008-03-27 - Patrick Robbe
 - src/L0CaloMonit.cpp: change binning for slot in crates
 - src/L0CaloCandidatesFromRaw.cpp: fix memory leaks in default container
   filling

! 2008-03-11 - Patrick Robbe
 - cmt/requirements: use Calo/CaloUtils
 - src/L0CaloAlg.cpp: remove unnecessary debuging output, add protection against
    double counting in duplicate candidates.
 - src/L0CaloMonit.cpp: use Calo2Dview base class.
 - src/L0CaloNtpMonitor.cpp: new class to fill Ntuples with L0Calo quantities.
 - src/L0CaloCandidatesFromRawBank.cpp: verify output level in debugging messages

!========================= L0Calo v9r11 2007-12-12 ========================
! 2007-12-12 - Patrick Robbe
 - src/L0CaloAlg.cpp: set correct version number to L0Calo raw bank
 - src/L0CaloCandidatesFromRawBank: allow decoding of old DC06 banks
  (version 0).

! 2007-10-31 - Marie-Helene Schune, Patrick Robbe, (Olivier Deschamps)
 - implement the final bank format as defined in EDMS-845277
   NB : this requires "HadronSB" condition to be included in  condDB
        (from SQLDDDB v3r1)

!========================= L0Calo v9r10 2007-11-01 ========================
! 2007-10-31 - Patrick Koppenburg
 - increment to v9r10

! 2007-10-31 - Olivier Deschamps 	
 - adapt to change in L0DUBase.h 

!========================= L0Calo v9r9 2007-07-18 =========================
! 2007-07-02 - Patrick Robbe
 - L0CaloAlg.cpp: 
    * update HCAL energy with ECAL in front also if HCAL Et=0
    * for particular cases where Front-End boards are partially used
      (HCAL for example), only transmit data to neighbour cards if
      the connection is physically present and not masked in the 
      hardware.
    * if the candidate's cellID is not valid, use (in this order) the top 
      cellID, the right cellID (if the top is not valid) or the corner cellID 
      (it the right is not valid) instead, to follow what is done in the
      hardware
 - TriggerCard.cpp: use left bottom valid cell of the board as default address
   when the card has 0 energy deposited in it.

!========================= L0Calo v9r8 2007-06-05 =========================
! 2007-06-05 - Marco Cattaneo
 - Adapt usage of rootInTES to Gaudi v19r4 conventions

!========================= L0Calo v9r7 2007-03-01 =========================
! 2007-03-01 - Marco Cattaneo
 - Remove obsolete L0Calo_load.cpp file, and an LHCbDefinitions include
 - Fix doxygen warning

! 2007-02-22 - Olivier Deschamps
 - Adapt to change in CaloDAQ
 - protect against the possibility to have Pin-diode FE-Cards in condDB
	(rejected from the L0Calo processing)

!========================= L0Calo v9r6 2006-11-23 =========================
! 2006-11-22 - Olivier Callot
 - Add the rootOnTES() prefix where needed.

!========================= L0Calo v9r5 2006-11-07 =========================
! 2006-11-07 - Olivier Callot
 - Remove the hardcoding of the Et scale, get it from condb in 
   L0CaloCandidateFromRawBank. Remove its unused computation in L0CaloAlg

! 2006-11-07 - Marco Cattaneo
 - use DECLARE_ALGORITHM_FACTORY macro
 - Get SystemOfUnits.h from GaudiKernel

! 2006-11-07 - Olivier Callot
 - Split L0CaloCandidatesFromRaw into a simple algorithm and a tool doing the
   real copnversion from Raw Bank to TES objects.
 - Use this tool to put the result of L0CaloAlg directly on TES if the option
   StoreInBuffer is false (default true). This allows to re-process L0Calo 
   without modifying the Raw Event.

!========================= L0Calo v9r4 2006-08-31 =========================
! 2006-08-31 - Olivier Callot
 - Fix a nasty problem in connecting HCAL to ECAL cards: The first cell of the 
   first HCAL card doesn't exist -> its size was zero, and then no ECAL-HCAL
   connection was made. Found by Valgrind! Not, warning message if the cards
   are not all connected.

!========================= L0Calo v9r3 2006-05-17 =========================
! 2006-05-17 - Marco Cattaneo
 - Adapt to Gaudi::Units

!========================= L0Calo v9r2 2006-04-12 =========================
! 2006-04-12 - Olivier Callot
 - Split the Raw Bank produced by L0CaloCandidate into two banks, one for 
   HCAL and one for the rest

!========================= L0Calo v9r1 2006-03-22 =========================
! 2006-03-22 - Olivier Deschamps
 - Fix bug in L0CaloCandidateFromRaw.cpp : CaloCandidate type 
    from L0DUBase::Fiber enum (L0Calo enum removed in L0Event).
 - Update L0CaloMonit.cpp & L0CaloToMCParticleAsct.cpp as well
 - Remove L0Calo.h include in L0CaloAlg.cpp

!========================= L0Calo v9r0 2006-03-09 =========================
! 2006-03-09 - Marco Cattaneo
 - Adapt to new LinkerWithKey interface

! 2006-02-23 - Olivier Callot
 - Fix bug in decoding L0CaloCandidateFromRaw: Bank size is in bytes...

! 2006-02-13 - Olivier Callot
 - Remove production of L0CaloCandidate in L0CaloAlg. Only RawEvent is produced.

! 2006-01-26 - Olivier Callot
 - Full adaptation to the LHCb v20 event model, i.e. add LHCb:: in many places

! 2005-12-02 - Olivier Callot
 - Remove the obsolete second strategies for pi0, L and G
 - Get the Et scale from conditions

! 2005-11-10 - Olivier Callot
 - Remove coding of L1 buffer
 - Adapt to new interfaces for Raw buffer, not yet final.

!========================= L0Calo v8r2 2005-05-10 =========================
! 2005-05-10 - Olivier Callot
 - Delete RawEvent invalidated by changes to RawBuffer in L0CaloAlg

!========================= L0Calo v8r1 2005-03-07 =========================
! 2005-03-07 - Marco Cattaneo
 - Adapt to new L1Buffer bank types in DAQEvent v5r0 (backwards incompatible)

! 2005-02-21 - Olivier Callot
 - Fix a typo in the filling of the SpdMult histo in L0CaloMonit

!========================= L0Calo v8r0 2005-01-14 =========================
! 2005-01-12 - Olivier Callot
 - Remove obsolete option files and directory

! 2005-01-10 - Olivier Callot
 - Adapt L0CaloAlg to GaudiAlgorithm
 - Use CaloDAQ to decode the L0 input data, i.e. Ecal/Hcal trigger ADC and
   Prs/SPD bits.
 - Adapt L0CaloMonit to GaudiMonitAlg
 - Adapt L0CaloToMCParticleAsct to GaudiAlgorithm

!========================= L0Calo v7r6 2004-05-24 =========================
! 2004-05-19 - Olivier Callot
 - Protect the size of the L1 output bank to not exceed 126 words, to avoid
   triggering an exception and a job abort in this rare case.

!========================= L0Calo v7r5 2004-04-28 =========================
! 2004-04-28 - Olivier Callot
 - Fixed a major bug in filling the L1Buffer: one need to push two 16 bit
   words to get the 32 bit candidate.
 - Debug the L1Buffer content in L0CaloMonit at debug level.

!========================= L0Calo v7r4 2004-03-31 =========================
! 2004-03-30 - Olivier Callot
 - Fix a bug in the recreation of the default container, the test was comparing
   the float Et to the integer EtCode to get the highest candidate...

! 2004-03-22 - Olivier Callot
 - Recreate L0CaloCandidates default container from the Full container in 
   L0CaloCandidatesFromRaw

!========================= L0Calo v7r3 2004-02-05 =========================
! 2004-02-05 - Olivier Callot
 - Replace the old Associator/Relations by the new Linker representation of the
   relation between L0CaloCandidates and MCParticles.

!========================= L0Calo v7r2 2004-01-07 =========================
! 2004-01-06 - Marco Cattaneo
 - Move to Gaudi v14 (use CaloEvent v13r* and L0Event v14r* in requirements)

! 2003-12-15 - Olivier Callot
 - Process the L0CaloAlg from the Hlt buffer. No longer need for L0CaloDigit
 - L0CaloCandidates are saved in the L1 and HLT buffers. No threshold for
   HLT buffer (non zero candidates only !) but individual threshold for
   L1 buffer, controlled by options (L1XXXXThr where XXXX is Electron Photon,
   hadron, Pi0Global and Pi0Local ) and listed in initialization. The total
   HCAL ET and the SPD multiplicity are always output in both buffers.

   Writing to L1 and HLT buffer can be switched off by setting the option
   'StoreInBuffer = false;'
 - New algorithm L0CaloCandidateFromRaw to restore the L0CaloCandidate (full). 
   Note that the restored full container includes also SPD multiplicity and 
   SumEt which are not available in the usual container.

!========================= L0Calo v7r1 2003-07-16 =========================
! 2003-07-16 - Marco Cattaneo
 - Use CaloEvent v12r*

!======================== L0Calo v7r0p1 2003-06-23 ========================
! 2003-06-23 - Olivier Callot
 - Fixes for gcc 3.2, pure technicalities.

!========================= L0Calo v7r0 2003-04-15 =========================
! 2003-04-03 - Marco Cattaneo
 - Move MC truth relations factories to Associators package, to avoid dependency
   on L0Calo when reading DSTs. To find the relations in an application:
   . add to the requirements:  use Associators v2r* Associators
   . add to the job options:   ApplicationMgr.DLLs += { "Associators" };  

!========================= L0Calo v6r6 2003-01-17 =========================
! 2003-01-16 - Olivier Callot
 - Fix Pi0Local per validation card: The 2x2 energy was used, instead of the
   total card energy.

!========================= L0Calo v6r5 2003-01-08 =========================
! 2003-01-06 - Olivier Callot
 - Fix an unitialized variable in the local L0Candidate class creator.

! 2002-12-15 - Olivier Callot
 - Produce in a separate container the list of inputs that the Selection Crate
   will receive, namely up-to (zero are removed) 28 electrons, photons, pi0L,
   pi0G and up to 50 hadrons.
 - Associate also truth with Pi0Global, using only the ID of the second card.

!========================= L0Calo v6r4 2002-12-05 =====================
! 2002-11-29 - Ivan Belyaev
 - cmt/requirements     version update

! 2002-11-26 - Florence Ranjard
 - requirements - use new versions

!========================= L0Calo v6r3 2002-11-22 =======================
! 2002-11-21 - Olivier Callot
 - For global pi0, perform ghost cleaning, i.e. don't add the two clusters
   if they share a cell.
 - Do global Pi0 also if the card is empty: The next may be not, and the total
   may be a good candidate, as the next may have no neighbour. Small effect !
 - Technical changes: log->msg, use 'format' instead of msg.width().
 - Photon trigger was and is EXCLUSIVE from electron trigger, i.e. when the Prs
   is ON, the candidate is either an electron (SPD ok) or a photon. As the 
   electron trigger has a lower threshold, this doesn't change the trigger 
   rate. But do not select photon trigger exclusively for photon physics !

! 2002-11-19 - Olivier Callot
 - Use the full calorimeter containers to start from the complete digits.
 - Add a Prs validation for the local pi0: At least one of the 4 cells.
 - Some obsolete code has been cleaned up.

!========================= L0Calo v6r2 2002-11-14 =======================
! 2002-11-14 - Marco Cattaneo
 - Force recompilation with CaloEvent v11r3

!========================= L0Calo v6r1 2002-07-18 =======================
! 2002-07-18 - Marco Cattaneo
 - Force recompilation with CaloEvent v11r1
 - Remove an INFO message

!========================= L0Calo v6r0 2002-07-09 =======================
! 2002-07-01 - Olivier Callot
 - New algorithm L0CaloToMCParticleAsct to build the relation between the
   L0CaloCandidates (electron, photon, pi0local, hadron and hadron2) and 
   MCParticle. This is based on the activeE from the hits, and a minimal 
   fraction of the sum is needed, default 10%, jobOption MinimalFraction
   The relation is stored in Rec/Relations/L0CaloCandidates which can be
   changed by jobOption OutputTable.

! 2002-06-25 - Marco Cattaneo
 - Use CaloDet v5r*

! 2002-06-10 - Marco Cattaneo
 - Change version to v6r0 to use EventKernel v2r*

!======================== L0Calo v5r0 2002-04-19 =========================
! 20020419 (M.Cattaneo)
  - Use AIDA v2r* (for Gaudi v10)

! 15/04/2002 - Olivier Callot
  - Add the SpdMult computation in L0CaloCandidate

! 05/04/2002 - Olivier Callot
  - Changes ObjectVector<CaloDigit> to CaloDigits in L0CaloDigit.cpp

! 04/04/2002 - Olivier Callot
  - Modified to adapt to L0Event v11r0, i.e. changed namespace L0:: to L0Calo::
  - Adapted for the new Calo Event model v10r0

!=============================================================================
! 01/02/2002 - Olivier Callot  ** v4r0 **
  - Use the default TES location from the Event class header files

!=============================================================================
! 30/01/2002 - Olivier Callot
  - Modified to use the new L0Event v10, based on xml.
  - Split the L0Calo algorithm :
    o L0CaloDigit (new) which produces the 8 bit Et and 1 bit Prs/Spd, in the 
      new event classes L0CaloAdc and L0PrsSpdHit
    o L0CaloAlg uses these classes to perfrom the same job as before.
  - Updated options/Brunel.opts for this new algorithm
  - Added options/DaVinci.opts to hold the DaVinci options.
  - Removed the L0Calo directory and its include L0CaloCandidate.h, which is
    now in Event/L0Event.

!=============================================================================
! 2002/01/08 - Marco Cattaneo ** v3r0 **
  Changes for Gaudi v9 and Calo v3:
  requirements      - use CaloEvent v7r*, CaloDet v3r*, AIDA v1r*
  L0CaloAlg.cpp     - get includes from CaloKernel instead of CaloGen
                      change default data container names to Digits (was Digit)
                      use recommended short names for service accessors
  L0CaloCandidate.h - get includes from CaloKernel instead of CaloGen
  L0CaloMonit.h     - get IHistogram1D.h from AIDA instead of GaudiKernel
!=============================================================================
! 12/07/2001 - Olivier Callot ** v2 **
  - Adapt to the new Gaudi/LHCb/Calo release: Increase version numbers and 
    remove buildCells / buildCards calls as this is now done automatically

!=============================================================================
! 12/06/2001 - Olivier Callot
  - New algorithm L0CaloMonit to fill histograms of the L0Calo trigger
  - New source file CLIDL0CaloCandidate.h for clean separation of CLID.
  - Added an SPD fixed threshold, as converted-DST are not properly Z-sup for
    the SPD. Because the SICBDST format has a single bank for Prs/Spd.

!==============================================================================
! 10/05/2001 - Olivier Callot
  Remove the HCAL clusters, no longer needed for Super-L1
  Correct some misuse of MsgStream, 
  provide a << operator to print L0CaloCandidate 

! 2001/04/30 - Olivier Callot
  Modified requirements to use Event/CaloEvent v5* which is already in DEV
 
! 2001/04/25 - Olivier Callot
  A cluster ID may be one of a non-existent cell. In this case the conversion
  to position is done with the other corner of the cluster

! 2001/04/19 - Olivier Callot
  Added the HCAL candidates in the output container, with a new type
  Fixed Windows NT incompatibilities, mainly loop indices are defined outside 
        the loop

! 2001/03/20 - Olivier Callot
  Change the code to have Doxygen compatible comments
  Add a typedef for L0CaloCandidateVector
  Fix the Streambuffer for the HepPoint3D member, i.e. read/write 3 coordinates

! 2001/03/07 - Olivier Callot
  Initial release of the package.
