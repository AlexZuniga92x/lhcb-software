!-----------------------------------------------------------------------------
! Package     : Tf/FastVelo
! Responsible : Olivier Callot
! Purpose     : Fast tracking in the Velo
!-----------------------------------------------------------------------------

! 2012-02-09 - Olivier Callot
 - Use the new 'wasDecoded' flag of the Velo sensor to count missed sensors.
 - Reserve space in vectors. (Feed back from Sasha Mazuroz's talk on 6/2/2012)
 - Copy vectors using the insert method.-> -4% time.

!========================= FastVelo v1r6 2011-12-15 ==========================
! 2011-11-22 - Marco Cattaneo
 - Fix a gcc46 warning and some icc remarks 

! 2011-10-27 - Olivier Callot
 - Loop on phi pair combination, not only the best one. Improve efficiency
   for tracks at large IP. Increases the ghost rate by 0.5%

! 2011-10-20 - Olivier Callot
 - Change the definition of dSin (remove centre offset ) in space search. 
   Gains some tracks...

! 2011-06-23 - V. Gligorov
 - Update default cut in FastTTValidation to 3.

!========================= FastVelo v1r5 2011-02-28 =========================
! 2011-02-17 - Olivier Callot
 - Fix the order of initializers in FastVeloTrack to avoid a compiler warning.

! 2011-02-15 - Olivier Callot
 - Add a joboption HitManagerName to FastVeloTracking for use in beam-gas HLT.

! 2011-02-11 - Olivier Callot
 - Fix uninitialized data members in FastVeloTrack, crashing the copy constructor.

! 2011-02-04 - Olivier Callot
 - Move the final printing from the destructor to the finalize method in FastVeloHitManager

!========================= FastVelo v1r4 2011-02-02 =========================
! 2011-02-02 - Olivier Callot
 - Protect the geometry from a double-float underflow, for the case of DC06...

! 2011-01-27 - Stephanie Hansmann-Menzemer
 - assign track history PatFastVelo to Velo tracks, add timing measurement options

! 2011-01-24 - Olivier Callot
 - Fix two bugs in the unused phi hits processing.

! 2011-01-21 - Olivier Callot
 - New tool FastTTValidationTool to validate a Velo track by TT for HLT1
 - New algorithm FastValidateWIthTT to test the tool.

!========================= FastVelo v1r3p1 2011-01-21 =========================
! 2011-01-19 - Olivier Callot
 - Fix the nPRVelo3DExpect track extrainfo value. A factor 2 was missing,

!========================= FastVelo v1r3 2011-01-17 =========================
! 2010-12-17 - Olivier Callot
 - Several improvements for higher efficiency at high nu. Mainly a change
   in deciding to stop searching for space tracks: Only when a tracks of same
   Phi length as R is found.

!========================= FastVelo v1r1 2010-12-16 =========================
! 2010-12-15 - Olivier Callot
 - Remove the info message when updating the geometry in FastVeloHitManager
 - Minor changes in the debug message of FastVeloTracking

!========================== FastVelo v1r0 2010-12-08 ===================
! 2010-12-06 - Olivier Callot
 - New option ZVertexMaxBck=1200 to allow tracks from beam2-gas. No time penalty but a 
   small increase in ghosts

! 2010-12-03 - Olivier Callot
 - Define backward tracks has having the z of closest approach to the beam 
   downstream of the measurements, independently of how they were produced.
 - New option ResetUsedFlags to be able to re-run FastVelo from scratch on the 
   same event, useful for beam gas in HLT.

! 2010-11-25 - Olivier Callot
 - Add a tool to refit a track starting from LHCbIDs.
 - Fix the tracking for Open geometry, i.e. some local/global transitions
   were incorrect.
 - For finding tracks starting from phi, change tolerances if few RZ tracks found.
   This helps the Open velo tracking.
 - Don't refit the track at the end with MSFactor. No gain and slower...

! 2010-11-12 - Olivier Callot
 - Fix the update of the geometry, on sensor's geometry, not whole Velo.
 - New control flags HLT1Only and HLT2Complement to setup the tracking in 
   HLT1 and the complement in HLT2. Result of the sequence is almost identical
   to running FastVeloTracking only once completely.
 - Add the number of expected R sensors on track. 

! 2010-10-20 - Olivier Callot
 - Change the option file name to define the output, for HLT compatibility

! 2010-10-19 - Olivier Callot
 - Fix the R error estimate on the RZ track
 - Final cleanup of the track, checking enough R and Phi after outlier removal
 - Change tolearnce to 16 (4 sigma) per hit, 40 to add a hit.
   All that gives a slight improvement in efficiency and hit efficiency.

! 2010-10-15 - Olivier Callot
 - In fact the linear system was not properly solved, and once fixed the Cholesky
   method is slower. I then put back the previous code.
 - Use the beam position as reference frame for RZ tracking, by correcting the 
   sensor offsets by the beam position.

! 2010-10-14 - Olivier Callot
 - As suggested by Manuel Schiller, the linear system is now solved using the
   Cholesky decomposition he wrote and which is now in ROOT. \
   This gains another ~7% of speed.
 - Force the update of teh geometry of the X offset of teh Velo halves has changed

! 2010-10-12 - Olivier Callot
 - Fix Windows compilation warnings (I hope...)

! 2010-10-11 - Olivier Callot
 - Fix the updateMgrSvc call to update the geometry.
 - Add option to measure the internal timing (MeasureTime = false)
 - Perform the unusedPhi search only if less than MaxRZForExtra = 200 tracks
   and if the number of space tracks found sofar is higher than half the 
   number of RZ tracks: Some events have ~ no space and many RZ...

! 2010-10-08 - Olivier Callot
 - Protect the case of an empty output container when merging clones.

! 2010-10-06 - Olivier Callot
 - First release of a stand-alone package to make fast space tracks in the Velo
   Efficiency, ghost rate, clone rate and speed are all better than the 
   current PatVelo algorythms.
